<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LapaDom ‚Äî –ù–∞–π—Ç–∏ –ø–µ—Ä–µ–¥–µ—Ä–∂–∫—É</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    .contact-info {
      display: none;
      margin-top: 10px;
      padding: 10px;
      background-color: #fff8dc;
      border: 1px solid #f0c420;
      border-radius: 6px;
    }

    .btn.secondary {
      background-color: #3a7c59;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.2s;
    }

    .btn.secondary:hover {
      background-color: #2c5c44;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ—Ç–∑—ã–≤–æ–≤ */
    .reviews-section {
      margin-top: 15px;
    }
    .review-form {
      display: none;
      margin-top: 10px;
      padding: 10px;
      background: #f9f9f9;
      border-radius: 5px;
    }
    .review-form.show {
      display: block;
    }
    .review-form input,
    .review-form select,
    .review-form textarea {
      width: 100%;
      margin-bottom: 10px;
      padding: 5px;
    }
    .review-item {
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    .review-header {
      display: flex;
      justify-content: space-between;
      font-weight: bold;
    }
    .star-rating {
      color: gold;
      font-size: 1.2em;
    }
    .show-reviews-btn {
      background: none;
      border: none;
      color: #3a7c59;
      cursor: pointer;
      text-decoration: underline;
      margin: 5px 0;
    }
    /* NEW: —Å—Ç–∏–ª—å –¥–ª—è –∑–≤—ë–∑–¥ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
    .rating-stars {
      color: gold;
      font-size: 1.1em;
      margin-left: 5px;
    }
  </style>
</head>
<body>

<header>
  <div class="container header-content">
    <div class="logo">üêæ <strong>LapaDom</strong></div>
    <nav>
      <ul class="menu">
        <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="catalog.html" class="active">–ù–∞–π—Ç–∏ –ø–µ—Ä–µ–¥–µ—Ä–∂–∫—É</a></li>
        <li><a href="sitter.html">–°—Ç–∞—Ç—å —Å–∏—Ç—Ç–µ—Ä–æ–º</a></li>
        <li><a href="rules.html">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–∞–≤–∏–ª–∞</a></li>
        <li><a href="contacts.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
      </ul>
    </nav>
  </div>
</header>

<section class="filters container">
  <h2>–§–∏–ª—å—Ç—Ä—ã</h2>
  <form id="filterForm">
    <label>
      –¢–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:
      <input type="text" id="animalType" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–±–∞–∫–∞">
    </label>
    <label>
      –ì–æ—Ä–æ–¥ / –†–∞–π–æ–Ω:
      <input type="text" id="cityFilter" placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥">
    </label>
    <label>
      –° –¥—Ä—É–≥–∏–º–∏ –∂–∏–≤–æ—Ç–Ω—ã–º–∏:
      <input type="checkbox" id="withOtherAnimals">
    </label>
    <label>
      –° –¥–µ—Ç—å–º–∏:
      <input type="checkbox" id="withChildren">
    </label>
    <button type="submit" class="btn btn-primary">–ù–∞–π—Ç–∏</button>
  </form>
</section>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ -->
<div class="sitter-grid" id="sitterGrid"></div>

<footer>
  <p>¬© 2025 LapaDom</p>
</footer>

<script>
  // ---------- –î–ê–ù–ù–´–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ ----------
  const defaultSitters = [
    {
      id: 'sofia_kazan',
      name: '–°–æ—Ñ–∏—è',
      city: '–∫–∞–∑–∞–Ω—å',
      animal: '—Å–æ–±–∞–∫–∞',
      withAnimals: false,
      withChildren: false,
      description: '–ì—É–ª—è—é, –∏–≥—Ä–∞—é –∏ —É–¥–µ–ª—è—é –º–∞–∫—Å–∏–º—É–º –≤–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ–±—ã –ø–∏—Ç–æ–º–µ—Ü –Ω–µ —Å–∫—É—á–∞–ª –ø–æ –≤–∞–º.',
      phone: '+7 916 294 79 55',
      email: 'Gromova.So@gmail.com',
      price: '1200',
      image: 'data:image/jpeg;base64,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',
      rating: 4
    },
   
    
  ];

  // ---------- –ü–†–ï–û–ë–†–ê–ó–û–í–ê–ù–ò–ï –ó–ê–Ø–í–ö–ò –ò–ó LOCALSTORAGE –í –§–û–†–ú–ê–¢ –°–ò–¢–¢–ï–†–ê ----------
  function convertApplicationToSitter(app) {
    const id = 'app_' + app.fullName.replace(/\s+/g, '_') + '_' + app.city.replace(/\s+/g, '_') + '_' + app.date;
    const animalString = Array.isArray(app.animalTypes) ? app.animalTypes.join(', ') : app.animalTypes || '–¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ';
    let description = app.description || '';
    if (app.experience) {
      description = '–û–ø—ã—Ç: ' + app.experience + '. ' + description;
    }
    const image = app.photoUrl || 'https://via.placeholder.com/300x200?text=–ù–µ—Ç+—Ñ–æ—Ç–æ';
    return {
      id: id,
      name: app.fullName,
      city: app.city.toLowerCase(),
      animal: animalString,
      withAnimals: app.withAnimals || false,
      withChildren: app.withChildren || false,
      description: description,
      phone: app.phone,
      email: app.email,
      price: app.price,
      image: image,
      rating: 5 // –Ω–æ–≤—ã–º —Å–∏—Ç—Ç–µ—Ä–∞–º —Å—Ç–∞–≤–∏–º –≤—ã—Å–æ–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    };
  }

  // ---------- –ó–ê–ì–†–£–ó–ö–ê –í–°–ï–• –°–ò–¢–¢–ï–†–û–í ----------
  function loadSitters() {
    const storedApproved = localStorage.getItem('approvedSitters');
    const approvedSitters = storedApproved ? JSON.parse(storedApproved) : [];
    
    const applications = JSON.parse(localStorage.getItem('sitterApplications') || '[]');
    const approvedApplications = applications.filter(app => app.status === 'approved');
    const convertedApps = approvedApplications.map(convertApplicationToSitter);
    
    const sittersMap = new Map();
    defaultSitters.forEach(s => sittersMap.set(s.id, s));
    approvedSitters.forEach(s => { if (!sittersMap.has(s.id)) sittersMap.set(s.id, s); });
    convertedApps.forEach(s => { if (!sittersMap.has(s.id)) sittersMap.set(s.id, s); });
    
    return Array.from(sittersMap.values());
  }

  // ---------- –°–û–•–†–ê–ù–ï–ù–ò–ï –û–î–û–ë–†–ï–ù–ù–´–• –í STORAGE ----------
  function saveApprovedSitters(approvedList) {
    localStorage.setItem('approvedSitters', JSON.stringify(approvedList));
  }

  window.addApprovedSitter = function(sitter) {
    if (!sitter.id) sitter.id = 'sitter_' + Date.now() + Math.random().toString(36).substr(2, 5);
    let approved = JSON.parse(localStorage.getItem('approvedSitters') || '[]');
    if (!approved.some(s => s.id === sitter.id)) {
      approved.push(sitter);
      saveApprovedSitters(approved);
      renderSitters(getCurrentFilter());
    }
  };

  // ---------- –ü–û–õ–£–ß–ï–ù–ò–ï –¢–ï–ö–£–©–ò–• –ó–ù–ê–ß–ï–ù–ò–ô –§–ò–õ–¨–¢–†–ê ----------
  function getCurrentFilter() {
    return {
      city: document.getElementById('cityFilter').value.toLowerCase().trim(),
      animal: document.getElementById('animalType').value.toLowerCase().trim(),
      withAnimals: document.getElementById('withOtherAnimals').checked,
      withChildren: document.getElementById('withChildren').checked
    };
  }

  // ---------- –§–£–ù–ö–¶–ò–Ø –û–ë–ù–û–í–õ–ï–ù–ò–Ø –†–ï–ô–¢–ò–ù–ì–ê (–ó–í–Å–ó–î) –í –ö–ê–†–¢–û–ß–ö–ï ---------- // <-- NEW
  function updateAverageRating(card) {
    const sitterId = card.dataset.sitterId;
    const reviews = JSON.parse(localStorage.getItem(`reviews_${sitterId}`)) || [];
    
    let average;
    if (reviews.length === 0) {
      // –ï—Å–ª–∏ –æ—Ç–∑—ã–≤–æ–≤ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–∞)
      average = parseFloat(card.dataset.defaultRating) || 5;
    } else {
      const sum = reviews.reduce((acc, r) => acc + r.rating, 0);
      average = sum / reviews.length;
    }
    
    // –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π –¥–ª—è –∫—Ä–∞—Å–æ—Ç—ã (–Ω–æ –∑–≤—ë–∑–¥—ã —Ü–µ–ª—ã–µ)
    const rounded = Math.round(average * 2) / 2; // –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Ü–µ–ª–æ–µ
    const fullStars = Math.floor(rounded);
    const halfStar = (rounded - fullStars) >= 0.5 ? 1 : 0;
    const emptyStars = 5 - fullStars - halfStar;
    
    let starsHtml = '‚òÖ'.repeat(fullStars);
    if (halfStar) starsHtml += '¬Ω'; // –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–º–≤–æ–ª –ø–æ–ª–æ–≤–∏–Ω—ã –∑–≤–µ–∑–¥—ã, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –æ—Å—Ç–∞–≤–∏–º —Ü–µ–ª—ã–µ
    starsHtml += '‚òÜ'.repeat(emptyStars);
    
    const starsSpan = card.querySelector('.rating-stars');
    if (starsSpan) {
      starsSpan.textContent = starsHtml;
    }
  }

  // ---------- –û–¢–†–ò–°–û–í–ö–ê –ö–ê–†–¢–û–ß–ï–ö ----------
  function renderSitters(filter = { city: '', animal: '', withAnimals: false, withChildren: false }) {
    const sitters = loadSitters();
    const grid = document.getElementById('sitterGrid');
    grid.innerHTML = '';

    let visibleCount = 0;

    sitters.forEach(s => {
      const matchesCity = !filter.city || s.city.toLowerCase().includes(filter.city);
      const matchesAnimal = !filter.animal || s.animal.toLowerCase().includes(filter.animal);
      const matchesAnimals = !filter.withAnimals || s.withAnimals === true;
      const matchesChildren = !filter.withChildren || s.withChildren === true;

      if (matchesCity && matchesAnimal && matchesAnimals && matchesChildren) {
        visibleCount++;
        const card = createSitterCard(s);
        grid.appendChild(card);
      }
    });

    if (visibleCount === 0) {
      const msg = document.createElement('p');
      msg.id = 'noResults';
      msg.textContent = 'üòø –ü–æ–¥—Ö–æ–¥—è—â–∏—Ö —Å–∏—Ç—Ç–µ—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã.';
      msg.style.textAlign = 'center';
      msg.style.marginTop = '20px';
      grid.appendChild(msg);
    } else {
      const oldMsg = document.getElementById('noResults');
      if (oldMsg) oldMsg.remove();
    }
  }

  // ---------- –°–û–ó–î–ê–ù–ò–ï –û–î–ù–û–ô –ö–ê–†–¢–û–ß–ö–ò (–° –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ò–ú –†–ï–ô–¢–ò–ù–ì–û–ú) ----------
  function createSitterCard(s) {
    const card = document.createElement('div');
    card.className = 'sitter-card';
    card.dataset.city = s.city;
    card.dataset.animal = s.animal;
    card.dataset.withAnimals = s.withAnimals;
    card.dataset.withChildren = s.withChildren;
    card.dataset.sitterId = s.id;
    card.dataset.defaultRating = s.rating; // <-- NEW —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

    card.innerHTML = `
      <img src="${s.image}" alt="${s.name}">
      <h3>${s.name}, ${s.city} <span class="rating-stars"></span></h3> <!-- NEW: –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–≤—ë–∑–¥ -->
      <p>${s.description}</p>
      <div class="contact-info">
        <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${s.phone}</p>
        <p><strong>Email:</strong> ${s.email}</p>
        <p><strong>–¶–µ–Ω–∞:</strong> ${s.price} ‚ÇΩ / —Å—É—Ç–∫–∏</p>
      </div>
      <button class="btn secondary contact-btn">–ö–∞–∫ —Å–æ –º–Ω–æ–π —Å–≤—è–∑–∞—Ç—å—Å—è</button>
      <div class="reviews-section">
        <button class="show-reviews-btn" onclick="toggleReviews(this)">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∑—ã–≤—ã</button>
        <div class="reviews-list" style="display: none;"></div>
        <div class="review-form">
          <h4>–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h4>
          <input type="text" class="review-name" placeholder="–í–∞—à–µ –∏–º—è" required>
          <select class="review-rating" required>
            <option value="">–û—Ü–µ–Ω–∏—Ç–µ —Å–∏—Ç—Ç–µ—Ä–∞</option>
            <option value="5">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ –û—Ç–ª–∏—á–Ω–æ</option>
            <option value="4">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ –•–æ—Ä–æ—à–æ</option>
            <option value="3">‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ</option>
            <option value="2">‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ –ü–ª–æ—Ö–æ</option>
            <option value="1">‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ –£–∂–∞—Å–Ω–æ</option>
          </select>
          <textarea class="review-text" placeholder="–í–∞—à –æ—Ç–∑—ã–≤..." required></textarea>
          <button class="btn secondary" onclick="submitReview(this)">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
        </div>
        <button class="review-btn" onclick="showReviewForm(this)">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
      </div>
    `;

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
    const contactBtn = card.querySelector('.contact-btn');
    contactBtn.addEventListener('click', () => {
      const info = card.querySelector('.contact-info');
      info.style.display = (info.style.display === 'block') ? 'none' : 'block';
    });

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –æ—Ç–∑—ã–≤—ã –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–µ–π—Ç–∏–Ω–≥
    displayReviews(card);
    updateAverageRating(card); // <-- NEW —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –∑–≤—ë–∑–¥—ã

    return card;
  }

  // ---------- –§–£–ù–ö–¶–ò–ò –î–õ–Ø –û–¢–ó–´–í–û–í ----------
  window.showReviewForm = function(button) {
    const card = button.closest('.sitter-card');
    const form = card.querySelector('.review-form');
    form.classList.toggle('show');
  };

  window.submitReview = function(button) {
    const card = button.closest('.sitter-card');
    const form = card.querySelector('.review-form');
    const name = card.querySelector('.review-name').value;
    const rating = card.querySelector('.review-rating').value;
    const text = card.querySelector('.review-text').value;

    if (!name || !rating || !text) {
      alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
      return;
    }

    const review = {
      name: name,
      rating: parseInt(rating),
      text: text,
      date: new Date().toLocaleDateString('ru-RU'),
      sitterId: card.dataset.sitterId
    };

    let reviews = JSON.parse(localStorage.getItem(`reviews_${review.sitterId}`)) || [];
    reviews.push(review);
    localStorage.setItem(`reviews_${review.sitterId}`, JSON.stringify(reviews));

    displayReviews(card);
    updateAverageRating(card); // <-- NEW –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∑–≤—ë–∑–¥—ã
    form.reset();
    form.classList.remove('show');
    alert('–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–∑—ã–≤!');
  };

  function displayReviews(card) {
    const sitterId = card.dataset.sitterId;
    const reviews = JSON.parse(localStorage.getItem(`reviews_${sitterId}`)) || [];
    const reviewsList = card.querySelector('.reviews-list');
    if (!reviewsList) return;

    reviewsList.innerHTML = '';

    if (reviews.length === 0) {
      reviewsList.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
      return;
    }

    reviews.forEach(review => {
      const item = document.createElement('div');
      item.className = 'review-item';
      item.innerHTML = `
        <div class="review-header">
          <span class="review-author">${review.name}</span>
          <span class="review-date">${review.date}</span>
        </div>
        <div class="star-rating">${'‚òÖ'.repeat(review.rating)}${'‚òÜ'.repeat(5-review.rating)}</div>
        <p>${review.text}</p>
      `;
      reviewsList.appendChild(item);
    });
  }

  window.toggleReviews = function(button) {
    const reviewsList = button.nextElementSibling;
    if (reviewsList.style.display === 'none') {
      reviewsList.style.display = 'block';
      button.textContent = '–°–∫—Ä—ã—Ç—å –æ—Ç–∑—ã–≤—ã';
    } else {
      reviewsList.style.display = 'none';
      button.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–∑—ã–≤—ã';
    }
  };

  // ---------- –û–ë–†–ê–ë–û–¢–ß–ò–ö –§–ò–õ–¨–¢–†–ê ----------
  document.getElementById('filterForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const filter = getCurrentFilter();
    renderSitters(filter);
  });

  // ---------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï ----------
  document.addEventListener('DOMContentLoaded', function() {
    renderSitters({ city: '', animal: '', withAnimals: false, withChildren: false });
  });
</script>

</body>
</html>
